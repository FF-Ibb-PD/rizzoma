/*
 *  jQuery selectBox - A cosmetic, styleable replacement for SELECT elements
 *
 *  Copyright 2012 Cory LaViska for A Beautiful Site, LLC.
 *
 *  https://github.com/claviska/jquery-selectBox
 *
 *  Licensed under both the MIT license and the GNU GPLv2 (same as jQuery: http://jquery.org/license)
 *
 */jQuery&&function(a){a.extend(a.fn,{selectBox:function(b,c){var d,e="",f=navigator.platform.match(/mac/i),g=function(b,c){var d;if(navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i))return!1;if(b.tagName.toLowerCase()!=="select")return!1;b=a(b);if(b.data("selectBox-control"))return!1;var e=a('<a class="selectBox" />'),f=b.attr("multiple")||parseInt(b.attr("size"))>1,g=c||{};e.width(b.outerWidth()).addClass(b.attr("class")).attr("title",b.attr("title")||"").attr("tabindex",parseInt(b.attr("tabindex"))).css("display","inline-block").bind("focus.selectBox",function(){this!==document.activeElement&&document.body!==document.activeElement&&a(document.activeElement).blur();if(e.hasClass("selectBox-active"))return;e.addClass("selectBox-active"),b.trigger("focus")}).bind("blur.selectBox",function(){if(!e.hasClass("selectBox-active"))return;e.removeClass("selectBox-active"),b.trigger("blur")}),a(window).data("selectBox-bindings")||a(window).data("selectBox-bindings",!0).bind("scroll.selectBox",o).bind("resize.selectBox",o),b.attr("disabled")&&e.addClass("selectBox-disabled"),b.bind("click.selectBox",function(a){e.focus(),a.preventDefault()});if(f){d=h(b,"inline"),e.append(d).data("selectBox-options",d).addClass("selectBox-inline selectBox-menuShowing").bind("keydown.selectBox",function(a){t(b,a)}).bind("keypress.selectBox",function(a){u(b,a)}).bind("mousedown.selectBox",function(b){a(b.target).is("A.selectBox-inline")&&b.preventDefault(),e.hasClass("selectBox-focus")||e.focus()}).insertAfter(b);if(!b[0].style.height){var k=b.attr("size")?parseInt(b.attr("size")):5,l=e.clone().removeAttr("id").css({position:"absolute",top:"-9999em"}).show().appendTo("body");l.find(".selectBox-options").html("<li><a> </a></li>");var m=parseInt(l.find(".selectBox-options A:first").html("&nbsp;").outerHeight());l.remove(),e.height(m*k)}z(e)}else{var p=a('<span class="selectBox-label" />'),q=a('<span class="selectBox-arrow" />');p.attr("class",i(b)).text(j(b)),d=h(b,"dropdown"),d.appendTo("BODY"),e.data("selectBox-options",d).addClass("selectBox-dropdown").append(p).append(q).bind("mousedown.selectBox",function(a){e.hasClass("selectBox-menuShowing")?o():(a.stopPropagation(),d.data("selectBox-down-at-x",a.screenX).data("selectBox-down-at-y",a.screenY),n(b))}).bind("keydown.selectBox",function(a){t(b,a)}).bind("keypress.selectBox",function(a){u(b,a)}).bind("open.selectBox",function(a,c){if(c&&c._selectBox===!0)return;n(b)}).bind("close.selectBox",function(a,b){if(b&&b._selectBox===!0)return;o()}).insertAfter(b);var r=e.width()-q.outerWidth()-parseInt(p.css("paddingLeft"))-parseInt(p.css("paddingLeft"));p.width(r),z(e)}b.addClass("selectBox").data("selectBox-control",e).data("selectBox-settings",g).hide()},h=function(b,c){var d,e=function(b,c){return b.children("OPTION, OPTGROUP").each(function(){if(a(this).is("OPTION"))a(this).length>0?A(a(this),c):c.append("<li> </li>");else{var b=a('<li class="selectBox-optgroup" />');b.text(a(this).attr("label")),c.append(b),c=e(a(this),c)}}),c};switch(c){case"inline":return d=a('<ul class="selectBox-options" />'),d=e(b,d),d.find("A").bind("mouseover.selectBox",function(c){q(b,a(this).parent())}).bind("mouseout.selectBox",function(c){r(b,a(this).parent())}).bind("mousedown.selectBox",function(a){a.preventDefault(),b.selectBox("control").hasClass("selectBox-active")||b.selectBox("control").focus()}).bind("mouseup.selectBox",function(c){o(),p(b,a(this).parent(),c)}),z(d),d;case"dropdown":d=a('<ul class="selectBox-dropdown-menu selectBox-options" />'),d=e(b,d),d.data("selectBox-select",b).css("display","none").appendTo("BODY").find("A").bind("mousedown.selectBox",function(a){a.preventDefault(),a.screenX===d.data("selectBox-down-at-x")&&a.screenY===d.data("selectBox-down-at-y")&&(d.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),o())}).bind("mouseup.selectBox",function(c){if(c.screenX===d.data("selectBox-down-at-x")&&c.screenY===d.data("selectBox-down-at-y"))return;d.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),p(b,a(this).parent()),o()}).bind("mouseover.selectBox",function(c){q(b,a(this).parent())}).bind("mouseout.selectBox",function(c){r(b,a(this).parent())});var f=b.attr("class")||"";if(f!==""){f=f.split(" ");for(var g in f)d.addClass(f[g]+"-selectBox-dropdown-menu")}return z(d),d}},i=function(b){var c=a(b).find("OPTION:selected");return("selectBox-label "+(c.attr("class")||"")).replace(/\s+$/,"")},j=function(b){var c=a(b).find("OPTION:selected");return c.text()||" "},k=function(b){b=a(b);var c=b.data("selectBox-control");if(!c)return;c.find(".selectBox-label").attr("class",i(b)).text(j(b))},l=function(b){b=a(b);var c=b.data("selectBox-control");if(!c)return;var d=c.data("selectBox-options");d.remove(),c.remove(),b.removeClass("selectBox").removeData("selectBox-control").data("selectBox-control",null).removeData("selectBox-settings").data("selectBox-settings",null).show()},m=function(b){b=a(b),b.selectBox("options",b.html())},n=function(b){b=a(b);var c=b.data("selectBox-control"),d=b.data("selectBox-settings"),e=c.data("selectBox-options");if(c.hasClass("selectBox-disabled"))return!1;o();var f=isNaN(c.css("borderBottomWidth"))?0:parseInt(c.css("borderBottomWidth"));e.width(c.innerWidth()).css({top:c.offset().top+c.outerHeight()-f,left:c.offset().left});if(b.triggerHandler("beforeopen"))return!1;var g=function(){b.triggerHandler("open",{_selectBox:!0})};switch(d.menuTransition){case"fade":e.fadeIn(d.menuSpeed,g);break;case"slide":e.slideDown(d.menuSpeed,g);break;default:e.show(d.menuSpeed,g)}d.menuSpeed||g();var h=e.find(".selectBox-selected:first");s(b,h,!0),q(b,h),c.addClass("selectBox-menuShowing"),a(document).bind("mousedown.selectBox",function(b){if(a(b.target).parents().andSelf().hasClass("selectBox-options"))return;o()})},o=function(){a(document).unbind("mousedown.selectBox"),a(".selectBox-dropdown-menu:visible").each(function(){var b=a(this),c=b.data("selectBox-select"),d=c.data("selectBox-control"),e=c.data("selectBox-settings");if(c.triggerHandler("beforeclose"))return!1;var f=function(){c.triggerHandler("close",{_selectBox:!0})};switch(e.menuTransition){case"fade":b.fadeOut(e.menuSpeed,f);break;case"slide":b.slideUp(e.menuSpeed,f);break;default:b.hide(e.menuSpeed,f)}e.menuSpeed||f(),d.removeClass("selectBox-menuShowing")})},p=function(b,c,d){b=a(b),c=a(c);var e=b.data("selectBox-control"),g=b.data("selectBox-settings");if(e.hasClass("selectBox-disabled"))return!1;if(c.length===0||c.hasClass("selectBox-disabled"))return!1;if(b.attr("multiple"))if(d.shiftKey&&e.data("selectBox-last-selected")){c.toggleClass("selectBox-selected");var h;c.index()>e.data("selectBox-last-selected").index()?h=c.siblings().slice(e.data("selectBox-last-selected").index(),c.index()):h=c.siblings().slice(c.index(),e.data("selectBox-last-selected").index()),h=h.not(".selectBox-optgroup, .selectBox-disabled"),c.hasClass("selectBox-selected")?h.addClass("selectBox-selected"):h.removeClass("selectBox-selected")}else f&&d.metaKey||!f&&d.ctrlKey?c.toggleClass("selectBox-selected"):(c.siblings().removeClass("selectBox-selected"),c.addClass("selectBox-selected"));else c.siblings().removeClass("selectBox-selected"),c.addClass("selectBox-selected");e.hasClass("selectBox-dropdown")&&e.find(".selectBox-label").text(c.text());var i=0,j=[];return b.attr("multiple")?e.find(".selectBox-selected A").each(function(){j[i++]=a(this).attr("rel")}):j=c.find("A").attr("rel"),e.data("selectBox-last-selected",c),b.val()!==j&&(b.val(j),k(b),b.trigger("change")),!0},q=function(b,c){b=a(b),c=a(c);var d=b.data("selectBox-control"),e=d.data("selectBox-options");e.find(".selectBox-hover").removeClass("selectBox-hover"),c.addClass("selectBox-hover")},r=function(b,c){b=a(b),c=a(c);var d=b.data("selectBox-control"),e=d.data("selectBox-options");e.find(".selectBox-hover").removeClass("selectBox-hover")},s=function(b,c,d){if(!c||c.length===0)return;b=a(b);var e=b.data("selectBox-control"),f=e.data("selectBox-options"),g=e.hasClass("selectBox-dropdown")?f:f.parent(),h=parseInt(c.offset().top-g.position().top),i=parseInt(h+c.outerHeight());d?g.scrollTop(c.offset().top-g.offset().top+g.scrollTop()-g.height()/2):(h<0&&g.scrollTop(c.offset().top-g.offset().top+g.scrollTop()),i>g.height()&&g.scrollTop(c.offset().top+c.outerHeight()-g.offset().top+g.scrollTop()-g.height()))},t=function(b,c){b=a(b);var d=b.data("selectBox-control"),f=d.data("selectBox-options"),g=b.data("selectBox-settings"),h=0,i=0;if(d.hasClass("selectBox-disabled"))return;switch(c.keyCode){case 8:c.preventDefault(),e="";break;case 9:case 27:o(),r(b);break;case 13:d.hasClass("selectBox-menuShowing")?(p(b,f.find("LI.selectBox-hover:first"),c),d.hasClass("selectBox-dropdown")&&o()):n(b);break;case 38:case 37:c.preventDefault();if(d.hasClass("selectBox-menuShowing")){var j=f.find(".selectBox-hover").prev("LI");h=f.find("LI:not(.selectBox-optgroup)").length,i=0;while(j.length===0||j.hasClass("selectBox-disabled")||j.hasClass("selectBox-optgroup")){j=j.prev("LI"),j.length===0&&(g.loopOptions?j=f.find("LI:last"):j=f.find("LI:first"));if(++i>=h)break}q(b,j),p(b,j,c),s(b,j)}else n(b);break;case 40:case 39:c.preventDefault();if(d.hasClass("selectBox-menuShowing")){var k=f.find(".selectBox-hover").next("LI");h=f.find("LI:not(.selectBox-optgroup)").length,i=0;while(k.length===0||k.hasClass("selectBox-disabled")||k.hasClass("selectBox-optgroup")){k=k.next("LI"),k.length===0&&(g.loopOptions?k=f.find("LI:first"):k=f.find("LI:last"));if(++i>=h)break}q(b,k),p(b,k,c),s(b,k)}else n(b)}},u=function(b,c){b=a(b);var f=b.data("selectBox-control"),g=f.data("selectBox-options");if(f.hasClass("selectBox-disabled"))return;switch(c.keyCode){case 9:case 27:case 13:case 38:case 37:case 40:case 39:break;default:f.hasClass("selectBox-menuShowing")||n(b),c.preventDefault(),clearTimeout(d),e+=String.fromCharCode(c.charCode||c.keyCode),g.find("A").each(function(){if(a(this).text().substr(0,e.length).toLowerCase()===e.toLowerCase())return q(b,a(this).parent()),s(b,a(this).parent()),!1}),d=setTimeout(function(){e=""},1e3)}},v=function(b){b=a(b),b.attr("disabled",!1);var c=b.data("selectBox-control");if(!c)return;c.removeClass("selectBox-disabled")},w=function(b){b=a(b),b.attr("disabled",!0);var c=b.data("selectBox-control");if(!c)return;c.addClass("selectBox-disabled")},x=function(b,c){b=a(b),b.val(c),c=b.val();var d=b.data("selectBox-control");if(!d)return;var e=b.data("selectBox-settings"),f=d.data("selectBox-options");k(b),f.find(".selectBox-selected").removeClass("selectBox-selected"),f.find("A").each(function(){if(typeof c=="object")for(var b=0;b<c.length;b++)a(this).attr("rel")==c[b]&&a(this).parent().addClass("selectBox-selected");else a(this).attr("rel")==c&&a(this).parent().addClass("selectBox-selected")}),e.change&&e.change.call(b)},y=function(b,d){b=a(b);var e=b.data("selectBox-control"),f=b.data("selectBox-settings");switch(typeof c){case"string":b.html(c);break;case"object":b.html("");for(var g in c){if(c[g]===null)continue;if(typeof c[g]=="object"){var i=a('<optgroup label="'+g+'" />');for(var j in c[g])i.append('<option value="'+j+'">'+c[g][j]+"</option>");b.append(i)}else{var l=a('<option value="'+g+'">'+c[g]+"</option>");b.append(l)}}}if(!e)return;e.data("selectBox-options").remove();var m=e.hasClass("selectBox-dropdown")?"dropdown":"inline";d=h(b,m),e.data("selectBox-options",d);switch(m){case"inline":e.append(d);break;case"dropdown":k(b),a("BODY").append(d)}},z=function(b){a(b).css("MozUserSelect","none").bind("selectstart",function(a){a.preventDefault()})},A=function(b,c){var d=a("<li />"),e=a("<a />");d.addClass(b.attr("class")),d.data(b.data()),e.attr("rel",b.val()).text(b.text()),d.append(e),b.attr("disabled")&&d.addClass("selectBox-disabled"),b.attr("selected")&&d.addClass("selectBox-selected"),c.append(d)};switch(b){case"control":return a(this).data("selectBox-control");case"settings":if(!c)return a(this).data("selectBox-settings");a(this).each(function(){a(this).data("selectBox-settings",a.extend(!0,a(this).data("selectBox-settings"),c))});break;case"options":if(c===undefined)return a(this).data("selectBox-control").data("selectBox-options");a(this).each(function(){y(this,c)});break;case"value":if(c===undefined)return a(this).val();a(this).each(function(){x(this,c)});break;case"refresh":a(this).each(function(){m(this)});break;case"enable":a(this).each(function(){v(this)});break;case"disable":a(this).each(function(){w(this)});break;case"destroy":a(this).each(function(){l(this)});break;default:a(this).each(function(){g(this,b)})}return a(this)}})}(jQuery);