sinon = require('sinon')

class SinonPlus
    constructor: () ->
        @_pool = [] # Пул из объектов

    mock: (obj) ->
        ### Кладёт мок в пул объектов. ###
        mock = sinon.mock(obj)
        @_pool.push(mock)
        return mock

    stub: (obj, method_name, func) ->
        ### Создаёт стаб для метода и кладёт его в пул. ###
        stub = sinon.stub(obj, method_name, func)
        @_pool.push stub
        return stub

    verifyAll: () ->
        for element in @_pool
            if element instanceof sinon.mock
                element.verify()

    restoreAll: () ->
        for element in @_pool
            element.restore?()
        @_pool = [] # Очищаем пул

module.exports = new SinonPlus()